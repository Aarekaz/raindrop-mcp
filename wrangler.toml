# Cloudflare Workers Configuration
# See: https://developers.cloudflare.com/workers/wrangler/configuration/

name = "raindrop-mcp"
main = "build/cloudflare-worker.js"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Workers configuration
workers_dev = true
route = ""
zone_id = ""

# Account ID (get from Cloudflare dashboard)
# account_id = "your_account_id_here"

# Environment variables (for development)
# For production, set these in the Cloudflare dashboard or via wrangler secrets
[vars]
NODE_ENV = "development"
CORS_ORIGIN = "*"

# Secrets (use: wrangler secret put RAINDROP_ACCESS_TOKEN)
# These are encrypted and not visible in wrangler.toml
# - RAINDROP_ACCESS_TOKEN
# - API_KEY

# Build configuration
[build]
command = "npm run build:cloudflare"

# Upload configuration
[build.upload]
format = "modules"
main = "./build/cloudflare-worker.js"

# Limits and resources
[limits]
# CPU time limit (ms) - 10ms for free tier, 50ms for paid
cpu_ms = 50

# KV namespace bindings (optional - for session storage)
# Uncomment and configure if using KV for session management
# [[kv_namespaces]]
# binding = "SESSIONS"
# id = "your_kv_namespace_id"
# preview_id = "your_preview_kv_namespace_id"

# Durable Objects bindings (optional - for persistent SSE connections)
# Uncomment and configure if using Durable Objects
# [[durable_objects.bindings]]
# name = "SSE_CONNECTIONS"
# class_name = "SSEConnection"
# script_name = "raindrop-mcp"

# [[migrations]]
# tag = "v1"
# new_classes = ["SSEConnection"]

# Production environment
[env.production]
name = "raindrop-mcp-production"
workers_dev = false
route = "raindrop-mcp.your-domain.com/*"
vars = { NODE_ENV = "production" }

# Staging environment
[env.staging]
name = "raindrop-mcp-staging"
workers_dev = true
vars = { NODE_ENV = "staging" }

# Custom domains (optional)
# [[routes]]
# pattern = "raindrop-mcp.example.com/*"
# zone_name = "example.com"

# Analytics Engine (optional - for monitoring)
# [observability]
# enabled = true

# Tail consumers (optional - for log streaming)
# [[tail_consumers]]
# service = "your-log-consumer"
